<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Products | Charhate Medical and Distributor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Premium Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&
  family=Noto+Sans+Devanagari:wght@300;400;500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/png" href="images/logo.png" />
</head>

<body>

<header class="site-header">
  <div class="header-inner">
    <div class="brand">
      <img src="images/logo.png" class="brand-logo" alt="Logo">
      <div class="brand-text">
        <h1>Charhate Medical and Distributor</h1>
        <p>Product Catalogue</p>
      </div>
    </div>

    <nav class="main-nav">
      <a href="index.html">Home / ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§™‡•É‡§∑‡•ç‡§†</a>
      <a href="catalog.html">Products / ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§®‡•á</a>
      <a href="order.html">Order Online / ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§ë‡§∞‡•ç‡§°‡§∞</a>
      <a href="dashboard.html">Admin / ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§®</a>
    </nav>
  </div>
</header>

<section class="section">
  <div class="section-header">
    <h2 style="font-family: 'Noto Sans Devanagari', sans-serif;">‡§Ü‡§Æ‡§ö‡•Ä ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§®‡•á</h2>
    <p>(Product Catalogue)</p>
  </div>

  <!-- Search Bar -->
  <div class="section-header">
    <input id="searchInput" type="text" placeholder="Search products..."
      style="padding:10px 14px;border-radius:25px;border:1px solid rgba(245,196,83,0.4);
             width:100%;max-width:350px;background:#050909;color:#e5e7eb;">
  </div>

  <!-- Dynamic products will be injected here -->
  <div id="catalogContainer"></div>
</section>

<!-- Back to Home -->
<div style="text-align:center;margin-top:30px;">
  <a href="index.html" class="btn outline small">‚¨Ö ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§™‡•É‡§∑‡•ç‡§†‡§æ‡§µ‡§∞ ‡§ú‡§æ (Back to Home)</a>
</div>

<footer class="site-footer">
  <p>¬© 2023 Charhate Medical and Distributor</p>
</footer>

<script>
  // üëâ Replace this with your actual published CSV URL from Google Sheets
  const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR8PnK0BnjvcYRZCjYSftjYE5Qh2S7H3oqcxyAvNMUom9rGT_PQcibFgCyvR5S_DjhVUxdnfR7lvdkt/pub?gid=0&single=true&output=csv";

  const searchInput = document.getElementById('searchInput');
  const container = document.getElementById('catalogContainer');

  let allProducts = []; // will hold parsed products

  async function loadProducts() {
    try {
      const res = await fetch(SHEET_CSV_URL);
      const csv = await res.text();
      parseCSV(csv);
      renderProducts(allProducts);
    } catch (e) {
      console.error("Error loading products:", e);
      container.innerHTML = "<p>Unable to load products. Please try again later.</p>";
    }
  }

  function parseCSV(csv) {
    const lines = csv.trim().split("\n");
    const headers = lines[0].split(",").map(h => h.trim().toLowerCase());

    const catIdx = headers.indexOf("category");
    const nameIdx = headers.indexOf("name");
    const descIdx = headers.indexOf("description");
    const priceIdx = headers.indexOf("price");

    allProducts = lines.slice(1).map(line => {
      const cols = line.split(",").map(c => c.trim());
      return {
        category: cols[catIdx] || "",
        name: cols[nameIdx] || "",
        description: cols[descIdx] || "",
        price: cols[priceIdx] || ""
      };
    }).filter(p => p.name); // ignore empty rows
  }

  function renderProducts(list) {
    container.innerHTML = "";

    // group by category
    const byCategory = {};
    list.forEach(p => {
      const cat = p.category || "Other";
      if (!byCategory[cat]) byCategory[cat] = [];
      byCategory[cat].push(p);
    });

    const marathiLabels = {
      "Medicines": "‡§î‡§∑‡§ß‡•á",
      "Pet Food": "‡§™‡§æ‡§≥‡•Ä‡§µ ‡§™‡•ç‡§∞‡§æ‡§£‡•Ä ‡§ñ‡§æ‡§¶‡•ç‡§Ø",
      "Grooming": "‡§ó‡•ç‡§∞‡•Ç‡§Æ‡§ø‡§Ç‡§ó ‡§∏‡§æ‡§π‡§ø‡§§‡•ç‡§Ø",
      "Accessories": "‡•≤‡§ï‡•ç‡§∏‡•á‡§∏‡§∞‡•Ä‡§ú"
    };

    Object.keys(byCategory).forEach(cat => {
      const products = byCategory[cat];

      // Section header
      const secHeader = document.createElement("div");
      secHeader.className = "section-header";
      const h2 = document.createElement("h2");
      h2.style.fontFamily = "'Noto Sans Devanagari', sans-serif";
      h2.style.fontSize = "1.3rem";
      h2.textContent = marathiLabels[cat] || cat;
      const p = document.createElement("p");
      p.textContent = `(${cat})`;
      secHeader.appendChild(h2);
      secHeader.appendChild(p);
      container.appendChild(secHeader);

      // Cards grid
      const grid = document.createElement("div");
      grid.className = "card-grid";

      products.forEach(prod => {
        const card = document.createElement("div");
        card.className = "card product-card";
        card.dataset.name = prod.name.toLowerCase();

        card.innerHTML = `
          <h3>${prod.name}</h3>
          <p>${prod.description}</p>
          <p><strong>‚Çπ${prod.price}</strong></p>
        `;
        grid.appendChild(card);
      });

      container.appendChild(grid);
    });
  }

  // Search filtering
  searchInput.addEventListener('input', function () {
    const q = this.value.toLowerCase();
    const filtered = allProducts.filter(p =>
      p.name.toLowerCase().includes(q) ||
      p.category.toLowerCase().includes(q) ||
      p.description.toLowerCase().includes(q)
    );
    renderProducts(filtered);
  });

  // Initial load
  loadProducts();
</script>

</body>
</html>
