<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Login | Charhate Medical</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Premium Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&
family=Noto+Sans+Devanagari:wght@300;400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">

<style>
.login-box {
  max-width: 380px;
  margin: 60px auto;
  padding: 25px;
  background: #0f1613;
  border: 1px solid rgba(245,196,83,0.4);
  border-radius: 16px;
  text-align: center;
  box-shadow: var(--shadow-soft);
}
.login-box h2 {
  margin-bottom: 12px;
  font-family: 'Noto Sans Devanagari';
}
.login-box input {
  width: 100%;
  padding: 10px;
  margin: 10px 0;
  border-radius: 10px;
  border: 1px solid rgba(148,163,184,0.4);
  background: #050909;
  color: white;
  font-size: 1rem;
}
#error {
  color: #ff6b6b;
  margin-top: 10px;
}
</style>
</head>

<body>

<div class="login-box">
  <h2>प्रशासन प्रवेश</h2>
  <p>(Admin Login)</p>

  <input id="username" placeholder="Username">
  <input id="password" type="password" placeholder="Password">

  <button class="btn primary" onclick="checkLogin()">Login</button>

  <p id="error"></p>
</div>

<script>
// ✔ Your Google Sheet CSV Link
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR8PnK0BnjvcYRZCjYSftjYE5Qh2S7H3oqcxyAvNMUom9rGT_PQcibFgCyvR5S_DjhVUxdnfR7lvdkt/pub?gid=0&single=true&output=csv";

async function checkLogin() {
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();

  if (!u || !p) {
    document.getElementById("error").innerText = "Please enter username and password.";
    return;
  }

  try {
    const res = await fetch(SHEET_URL);
    const csv = await res.text();

    const rows = csv.trim().split("\n");
    const headers = rows[0].split(",").map(h => h.trim().toLowerCase());

    const userIdx = headers.indexOf("username");
    const passIdx = headers.indexOf("password");

    if (userIdx === -1 || passIdx === -1) {
      document.getElementById("error").innerText = "Sheet format incorrect. Fix headers.";
      return;
    }

    for (let i = 1; i < rows.length; i++) {
      const cols = rows[i].split(",");

      const sheetUser = cols[userIdx].replace(/"/g, "").trim();
      const sheetPass = cols[passIdx].replace(/"/g, "").trim();

      if (u === sheetUser && p === sheetPass) {
        // Save auth in localStorage
        localStorage.setItem("admin-authenticated", "yes");
        window.location.href = "dashboard.html";
        return;
      }
    }

    document.getElementById("error").innerText = "Invalid username or password.";

  } catch (err) {
    console.error(err);
    document.getElementById("error").innerText = "Unable to verify login. Check CSV link.";
  }
}
</script>

</body>
</html>
